<% content_for(:title) { "Cassettes | #{@cassette.name}" } %>
<div class="row">
  <div class="col-md-12">
    <h1 class="text-break"><%= @cassette.name %></h1>
    <h2>Episodes <small class="text-muted"><%= @cassette.episodes.count %></small></h2>

    <div id="requests-table" class="ag-theme-alpine" style="height: 400px; width:auto;" />

    <script type="text/javascript" charset="utf-8">
      // specify the columns
      const columnDefs = [
        { field: "host", width: 370, sortable: true, filter: true, resizable: true },
        { field: "edit", width: 70,
          cellRenderer: function(params){
            const episode = params.data;
            return `<a href=${episode.edit_path} target="_blank">edit</a>` }
        },
        { field: "path", width: 800, sortable: true, filter: true, resizable: true,
          cellRenderer: function(params){
            const episode = params.data;
            return `<a href=${episode.url} target="_blank">${episode.path}</a>` }},
        { field: "query", width: 300, sortable: true, filter: true, resizable: true  }
      ];

      // specify the data
      const rowData = <%= @row_data.to_json.html_safe %>;

      // let the grid know which columns and what data to use
      const gridOptions = {
        columnDefs: columnDefs,
        rowData: rowData
      };

      // lookup the container we want the Grid to use
      const eGridDiv = document.querySelector('#requests-table');

      // create the grid passing in the div to use together with the columns & data we want to use
      new agGrid.Grid(eGridDiv, gridOptions);

    </script>
  </div>
</div>
